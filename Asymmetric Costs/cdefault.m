function [c,yT,yN,hT,hN]=cdefault(z,p)
%---------------------------------------------------------------------------------------------------------------------------
% Inputs:
%---------------------------------------------------------------------------------------------------------------------------
% z: productivity shock
% p: vector of parameters
% cF: indicator of default cost function: 
%   cF=1: Aguiar and Amador
%   cF=2: Arellano
%   cF=3: Chatterjee and Eyigungor
%---------------------------------------------------------------------------------------------------------------------------
% Outputs:
%---------------------------------------------------------------------------------------------------------------------------
% c: total consumption in default state
% yT and yN: production of tradable and nontradable in default state
% hT and hN; labor of tradable and non tradable sectors in default state
%---------------------------------------------------------------------------------------------------------------------------
% 1. Indicator:
%---------------------------------------------------------------------------------------------------------------------------
zdefT=min((1-p.chi1_T)*mean(z),z);
zdefN=min((1-p.chi1_N)*mean(z),z);
%---------------------------------------------------------------------------------------------------------------------------    
% 2. Constant relationships (see FOCs)
%---------------------------------------------------------------------------------------------------------------------------
cN_cT = (p.theta/(1-p.theta))^p.eta;
c_cT = ((1-p.theta)+p.theta*(cN_cT)^((p.eta-1)/p.eta)).^(p.eta/(p.eta-1));
c_cN = ((1-p.theta)*(1/cN_cT)^((p.eta-1)/p.eta)+p.theta).^(p.eta/(p.eta-1));
%---------------------------------------------------------------------------------------------------------------------------    
% 3. Labor per sector:
%---------------------------------------------------------------------------------------------------------------------------
hT = (p.alphaT*(1-p.theta)*c_cT.^(1/p.eta).*zdefT).^(1/(p.omegaT-p.alphaT));
hN = (p.alphaN*p.theta*c_cN.^(1/p.eta).*zdefN).^(1/(p.omegaN-p.alphaN));
%---------------------------------------------------------------------------------------------------------------------------    
% 4. Production per sector:
%---------------------------------------------------------------------------------------------------------------------------
yT = zdefT.*hT.^p.alphaT;
yN = zdefN.*hN.^p.alphaN; 
%---------------------------------------------------------------------------------------------------------------------------
% 5. Consumption per sector
%---------------------------------------------------------------------------------------------------------------------------
cT = max(yT,0);
cN = max(yN,0);
%---------------------------------------------------------------------------------------------------------------------------    
% 6. Total consumption
%---------------------------------------------------------------------------------------------------------------------------
c = ((1-p.theta).*cT.^((p.eta-1)/p.eta)+p.theta.*cN.^((p.eta-1)/p.eta)).^(p.eta/(p.eta-1));
%---------------------------------------------------------------------------------------------------------------------------
end